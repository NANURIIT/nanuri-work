<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.nanuri.work.business.member.mapper.MemberMapper">

	<select id="selectCommonCodeList" parameterType="com.nanuri.work.business.member.dto.CommonCodeDTO" resultType="com.nanuri.work.business.member.dto.CommonCodeDTO">
		SELECT ds_cd,
			   dtl_cd,
			   ds_cd_nm,
			   dtl_cnm
		  FROM comn_cd
    	 WHERE ds_cd = #{dsCd}
	  ORDER BY sort_seqn
	</select>
	
	<!-- 학력 -->
	<!-- 학력 입력 -->	
	<insert id="insertSchoolCareer" parameterType="com.nanuri.work.business.member.dto.SchoolCareerDTO">
		INSERT INTO mem_scca(
			rgmn_nm,
			user_id, 
			scca_ds_cd,
			majr_nm,
			schl_nm,
			etis_ym,
			grdu_ym
		) VALUES (
			#{rgmnNm}, 
			#{userId}, 
			#{sccaDsCd}, 
			#{majrNm}, 
			#{schlNm}, 
			#{etisYm}, 
			#{grduYm}
		)
	</insert>
	
	<!-- 학력 리스트 출력 -->
	<select id="selectSchoolCareerList" parameterType="string" resultType="com.nanuri.work.business.member.dto.SchoolCareerDTO">
		SELECT seq_no,
			   scca_ds_cd,
			   majr_nm,
			   schl_nm,
			   etis_ym,
			   grdu_ym
		  FROM mem_scca
		 WHERE user_id = #{userId}
		   AND del_yn = 'N'
	</select>
	
	<!-- 학력 상세 출력 -->
	<select id="selectSchoolCareerDetail" parameterType="long" resultType="com.nanuri.work.business.member.dto.SchoolCareerDTO">
		SELECT seq_no,
			   scca_ds_cd,
			   majr_nm,
			   schl_nm,
			   etis_ym,
			   grdu_ym,
			   del_yn
		  FROM mem_scca
		 WHERE seq_no = #{seqNo}
		   AND del_yn = 'N'
	</select>
	
	<!-- 학력 수정 -->
	<update id="updateSchoolCareer" parameterType="com.nanuri.work.business.member.dto.SchoolCareerDTO">
		UPDATE mem_scca
		   SET mdfp_nm = #{mdfpNm}, 
		       scca_ds_cd = #{sccaDsCd}, 
		       majr_nm = #{majrNm}, 
		       schl_nm = #{schlNm}, 
		       etis_ym = #{etisYm}, 
		       grdu_ym = #{grduYm}
 		 WHERE seq_no = #{seqNo}
	</update>
	
	<!-- 학력 삭제 -->
	<update id="deleteSchoolCareer" parameterType="com.nanuri.work.business.member.dto.SchoolCareerDTO">
		UPDATE mem_scca
   		   SET del_yn = 'Y', 
   		       mdfp_nm = #{mdfpNm}
   		 WHERE seq_no = #{seqNo}
	</update>
	
	
	<!-- 자격증 -->
	<!-- 자격증 입력 -->
	<insert id="insertCertificate" parameterType="com.nanuri.work.business.member.dto.CertificateDTO">
		INSERT INTO mem_qlfc (
			rgmn_nm, 
			user_id,
			qlfc_ds_cd,
			qlfc_nm,
			pbcpl_nm,
			acq_dt,
			vld_dt,
			updt_dt
		) VALUES (
			#{rgmnNm}, 
			#{userId}, 
			#{qlfcDsCd}, 
			#{qlfcNm}, 
			#{pbcplNm}, 
			#{acqDt}, 
			#{vldDt}, 
			#{updtDt}
		)
	</insert>
	
	<!-- 자격증 리스트 출력 -->
	<select id="selectCertificateList" parameterType="string" resultType="com.nanuri.work.business.member.dto.CertificateDTO">
		SELECT seq_no, 
			   qlfc_ds_Cd, 
			   qlfc_nm, 
			   pbcpl_nm, 
			   acq_dt, 
			   vld_dt, 
			   updt_dt
		  FROM mem_qlfc
		 WHERE user_id = #{userId}
		   AND del_yn = 'N'
	</select>
	
	<!-- 자격증 상세 출력 -->
	<select id="selectCertificateDetail" parameterType="long" resultType="com.nanuri.work.business.member.dto.CertificateDTO">
		SELECT seq_no, 
			   qlfc_ds_Cd, 
			   qlfc_nm, 
			   pbcpl_nm, 
			   acq_dt, 
			   vld_dt, 
			   updt_dt, 
			   del_yn
		  FROM mem_qlfc
		 WHERE seq_no = #{seqNo}
		   AND del_yn = 'N'
	</select>
	
	<!-- 자격증 수정 -->
	<update id="updateCertificate" parameterType="com.nanuri.work.business.member.dto.CertificateDTO">
		UPDATE mem_qlfc
		   SET mdfp_nm = #{mdfpNm},
		       qlfc_ds_cd = #{qlfcDsCd},
			   qlfc_nm = #{qlfcNm},
			   pbcpl_nm = #{pbcplNm},
			   acq_dt = #{acqDt},
			   vld_dt = #{vldDt},
			   updt_dt = #{updtDt}
		 WHERE seq_no = #{seqNo}
	</update>
	
	<!-- 자격증 삭제 -->
	<update id="deleteCertificate" parameterType="com.nanuri.work.business.member.dto.CertificateDTO">
		UPDATE mem_qlfc
		   SET del_yn = 'Y', 
		       mdfp_nm = #{mdfpNm}
		 WHERE seq_no = #{seqNo}
	</update>
	
	<!-- 회사소속이력 -->
	<!-- 회사소속이력 등록 -->
	<insert id="insertWorkhistory" parameterType="com.nanuri.work.business.member.dto.WorkhistoryDTO">
		INSERT INTO mem_svce_hst (
			rgmn_nm, 
			user_id, 
			wrkpl_nm, 
			enco_ym, 
			rtrm_ym, 
			dty_nm, 
			chrg_bsn_nm
		) VALUES (
			#{rgmnNm}, 
			#{userId}, 
			#{wrkplNm}, 
			#{encoYm}, 
			#{rtrmYm}, 
			#{dtyNm}, 
			#{chrgBsnNm}
		)
	</insert>
	
	<!-- 회사소속이력 리스트 출력 -->
	<select id="selectWorkhistoryList" parameterType="string" resultType="com.nanuri.work.business.member.dto.WorkhistoryDTO">
		SELECT seq_no, 
			   user_id, 
			   wrkpl_nm, 
			   enco_ym, 
			   rtrm_ym, 
			   dty_nm, 
			   chrg_bsn_nm
		  FROM mem_svce_hst
		 WHERE del_yn = 'N'
		   AND user_id = #{userId}
	</select>
	
	<!-- 회사소속이력 상세 출력 -->
	<select id="selectWorkhistoryDetail" parameterType="long" resultType="com.nanuri.work.business.member.dto.WorkhistoryDTO">
		SELECT seq_no, 
			   user_id, 
			   wrkpl_nm, 
			   enco_ym, 
			   rtrm_ym, 
			   dty_nm, 
			   chrg_bsn_nm, 
			   del_yn
		  FROM mem_svce_hst
		 WHERE del_yn = 'N'
		   AND seq_no = #{seqNo}
	</select>
	
	<!-- 회사소속이력 수정 -->
	<update id="updateWorkhistory" parameterType="com.nanuri.work.business.member.dto.WorkhistoryDTO">
		UPDATE mem_svce_hst
		   SET wrkpl_nm = #{wrkplNm},  
			   enco_ym = #{encoYm}, 
			   rtrm_ym = #{rtrmYm}, 
			   dty_nm = #{dtyNm}, 
			   chrg_bsn_nm = #{chrgBsnNm}
		 WHERE seq_no = #{seqNo}
	</update>
	
	<!-- 회사소속이력 삭제 -->
	<update id="deleteWorkhistory" parameterType="com.nanuri.work.business.member.dto.WorkhistoryDTO">
		UPDATE mem_svce_hst
		   SET del_yn = 'Y', 
		       mdfp_nm = #{mdfpNm}
		 WHERE seq_no = #{seqNo}
	</update>
	
	<!-- 프로젝트이력 -->	
	<!-- 프로젝트이력 등록 -->
	<insert id="insertCareerhistory" parameterType="com.nanuri.work.business.member.dto.CareerhistoryDTO">
		INSERT INTO mem_carr_hst (
			rgmn_nm, 
			user_id, 
			bz_nm, 
			bz_st_ym, 
			bz_ed_ym, 
			ordr_nm, 
			bz_cntn, 
			blg_co_nm, 
			rol_cd, 
			chrg_bsn_nm, 
			lang_nm, 
			db_nm, 
			os_nm, 
			use_frmwk_nm, 
			mth_nm, 
			etc_capa_nm
		) VALUES (
			#{rgmnNm}, 
			#{userId}, 
			#{bzNm}, 
			#{bzStYm}, 
			#{bzEdYm}, 
			#{ordrNm}, 
			#{bzCntn}, 
			#{blgCoNm}, 
			#{rolCd}, 
			#{chrgBsnNm}, 
			#{langNm}, 
			#{dbNm}, 
			#{osNm}, 
			#{useFrmwkNm}, 
			#{mthNm}, 
			#{etcCapaNm}
		)
	</insert>
	
	<!-- 프로젝트이력 리스트 출력 -->
	<select id="selectCareerhistoryList" parameterType="string" resultType="com.nanuri.work.business.member.dto.CareerhistoryDTO">
		SELECT T01.seq_no, 
	      	   T01.bz_nm, 
	      	   T01.bz_st_ym, 
	      	   T01.bz_ed_ym, 
	      	   T01.ordr_nm, 
	      	   T01.bz_cntn, 
	      	   T01.blg_co_nm, 
	      	   T02.dtl_cnm, 
	      	   T01.chrg_bsn_nm, 
	      	   T01.lang_nm, 
	      	   T01.db_nm, 
	      	   T01.os_nm, 
	      	   T01.use_frmwk_nm, 
	      	   T01.mth_nm, 
	      	   T01.etc_capa_nm
     	  FROM mem_carr_hst T01
	 LEFT JOIN comn_cd T02
     	    ON T01.rol_cd = T02.dtl_cd  
    	 WHERE user_id = #{userId}
      	   AND del_yn = 'N';
	</select>
	
	<!-- 프로젝트이력 상세 출력 -->
	<select id="selectCareerhistoryDetail" parameterType="long" resultType="com.nanuri.work.business.member.dto.CareerhistoryDTO">
		SELECT seq_no, 
			   bz_nm, 
			   bz_st_ym, 
			   bz_ed_ym, 
			   ordr_nm, 
			   bz_cntn, 
			   blg_co_nm, 
			   rol_cd, 
			   chrg_bsn_nm, 
			   lang_nm, 
			   db_nm, 
			   os_nm, 
			   use_frmwk_nm, 
			   mth_nm, 
			   etc_capa_nm, 
			   del_yn
		  FROM mem_carr_hst
		 WHERE seq_no = #{seqNo}
		   AND del_yn = 'N'
	</select>
	
	<!-- 경력이력 수정 -->
	<update id="updateCareerhistory" parameterType="com.nanuri.work.business.member.dto.CareerhistoryDTO">
		UPDATE mem_carr_hst
		   SET bz_nm = #{bzNm}, 
		       bz_st_ym = #{bzStYm}, 
		       bz_ed_ym = #{bzEdYm}, 
		       ordr_nm = #{ordrNm}, 
		       bz_cntn = #{bzCntn}, 
		       blg_co_nm = #{blgCoNm}, 
		       rol_cd = #{rolCd}, 
		       chrg_bsn_nm = #{chrgBsnNm}, 
		       lang_nm = #{langNm}, 
		       db_nm = #{dbNm}, 
		       os_nm = #{osNm}, 
		       use_frmwk_nm = #{useFrmwkNm}, 
		       mth_nm = #{mthNm}, 
		       etc_capa_nm = #{etcCapaNm}
		 WHERE seq_no = #{seqNo} 
	</update>
	
	<!-- 프로젝트이력 삭제 -->
	<update id="deleteCareerhistory" parameterType="com.nanuri.work.business.member.dto.CareerhistoryDTO">
		UPDATE mem_carr_hst
		   SET del_yn = 'Y', 
		   	   mdfp_nm = #{mdfpNm}
		 WHERE seq_no = #{seqNo}
	</update>
	
</mapper>